# Наполнить базу PLAZMA из бэкапа

Чтобы каталог в мини-приложении перестал быть пустым («Каталог пока пуст», «Товары временно недоступны»), восстановите данные из бэкапа.

## Вариант 1: Локальный файл бэкапа

Если в проекте уже есть файл бэкапа (например `database-backup-2025-12-07T17-30-20.json`):

```bash
# Из корня проекта, с указанием DATABASE_URL или MONGO_URL в .env
node scripts/restore-from-cloudinary.js "./database-backup-2025-12-07T17-30-20.json"
```

или через npm:

```bash
npm run restore -- "./database-backup-2025-12-07T17-30-20.json"
```

## Вариант 2: Последний бэкап из Cloudinary

Если бэкапы залиты в Cloudinary (папка `plazma-bot/backups`), в `.env` должны быть заданы `CLOUDINARY_CLOUD_NAME`, `CLOUDINARY_API_KEY`, `CLOUDINARY_API_SECRET`. Тогда:

```bash
npm run restore
```

Скрипт сам возьмёт последний бэкап из Cloudinary и восстановит базу.

## Вариант 3: Railway (продакшен)

На Railway с подключённой БД и переменными окружения:

```bash
railway run npm run restore
```

Или с локальным файлом (если файл загружен на Railway или доступен по URL):

```bash
railway run node scripts/restore-from-cloudinary.js "https://res.cloudinary.com/.../plazma-bot/backups/database-backup-....json"
```

## После восстановления

- Перезапустите приложение (или дождитесь перезапуска на Railway).
- Обновите мини-приложение в Telegram — каталог должен отобразить товары и категории из бэкапа.

## Проверка локальных бэкапов

```bash
ls -la database-backup-*.json
node scripts/list-cloudinary-backups.js   # список в Cloudinary
```
